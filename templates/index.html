<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>YARA to Sigma Converter</title>
    <style>
      body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      h1 {
        color: #333;
      }
      textarea {
        width: 100%;
        min-height: 200px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        resize: vertical;
        font-family: monospace;
      }
      select, button {
        padding: 8px 12px;
        border-radius: 4px;
        border: 1px solid #ccc;
        font-size: 14px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      .output {
        background-color: #fafafa;
        color: #333;
        border: 1px solid #ddd;
      }
    </style>
  </head>
  <body>
    <h1>YARA to Sigma Converter</h1>
    <p>
      Paste a YARA rule below, choose your target backend and click
      <strong>Convert</strong> to generate a Sigma rule and a simple search query.
    </p>
    <form method='post'>
      <div class='form-group'>
        <label for='yara'><strong>YARA Rule</strong></label><br />
        <textarea
          name='yara'
          id='yara'
          placeholder='Paste your YARA rule here'
        >{{ yara_text|e }}</textarea>
      </div>
      <div class='form-group'>
        <label for='backend'><strong>Backend</strong></label>
        <select name='backend' id='backend'>
          <option value='elastic' {% if backend == 'elastic' %}selected{% endif %}>
            Elastic / ELK
          </option>
          <option value='splunk' {% if backend == 'splunk' %}selected{% endif %}>
            Splunk
          </option>
        </select>
      </div>
      <div class='form-group'>
        <button type='submit'>Convert</button>
      </div>
    </form>
    {% if sigma_text %}
      <h2>Generated Sigma Rule</h2>
      <textarea class='output' readonly>{{ sigma_text }}</textarea>
      <h2>{{ backend|capitalize }} Query</h2>
      <textarea class='output' readonly>{{ query_text }}</textarea>
    {% endif %}
    <p style='font-size: 0.8em; color: #666; margin-top: 40px;'>
      Created by wahid_hendrawan
    </p>
  </body>
</html>
